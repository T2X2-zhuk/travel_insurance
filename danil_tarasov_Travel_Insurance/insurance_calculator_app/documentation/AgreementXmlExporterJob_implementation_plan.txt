План (доработанный) по реализации экспорта агриментов в xml файлы.

Бизнес требования.

Для интеграции с внешней системой необходимо регулярно
выгружать данные по полисам в файлы. Данные по каждому полису
должны быть выгружены в отдельные файлы. Формат файлов: xml.
Данные должны содержать все поля полиса, персон и рисков, а так же
рассчитанные премии.

Данные в файлы необходимо выгружать на регулярной основе, один раз в сутки.


Техническое описание.

1. Создать в корне проекта директорию export/agreements/xml,
в эту директорию будет осуществляться выгрузка.

2. Для реализации выгрузки агриментов в xml файлы будем использовать
background процесс (джоб).

3. Джоб по реализации выгрузки аргиментов в xml размещаем в
пакете insurance/jobs (на одном уровне с web/rest/core).

4. В core для получения всех uuid агриментов из базы данных
создаем новую команду.

5. Обрабатывать полученные uuid будем по одному.

5. Используя уже существующую команду получения аргимента по его
uuid будем получать данные агримента из базы данных.

6. Получив данные агримента преобразуем их в xml и сохраняем в файл.

7. У файлов будут названия agreement-uuid.xml.

8. Если файл с таким названием уже существует просто переписываем
его содержимое.

9. Для тестирования джоба настроим запуск джоба раз в 5 минут
и проверяем работу джоба вручную.

10. Реализуем включалку/выключалку для джоба через свойство в
application.properties.

#-spring.profiles.active=h2
#-spring.profiles.active=mysql-local
#-spring.profiles.active=mysql-container

#./gradlew docker
#docker container create --name insurance-calculator -p 8080:8080  insurance-calculator:1.0.4
#docker container start insurance-calculator -i
#docker pull mysql:8.0
#docker run --name mysql-container -e MYSQL_ROOT_PASSWORD=fkmdbyjdbx383 -e MYSQL_DATABASE=insurance-calc-db -p 3000:3306 -d mysql:8.0
